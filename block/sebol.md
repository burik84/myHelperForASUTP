# Sebol

## Об использовании
Я сталкивался с применением SEBOL'a в блоках SFC и CALCU. CALCU у меня есть отдельный файл, а SFC (функциональная схема последовательности) - графический язык программирования, применяемый для определения последовательностей управления.

SEquence and Batch Oriented Language (SEBOL) - язык программирования, предназначенный для управления процессами.

## Вводная часть
ссылка на главу самоучителя о [SEBOL](https://www.maxplant.ru/article/centum_tutorial_5.php)
Комментарии
```
! Текст комментария
```
Специальные символы в константах
* Перевод на новую строку `\n`
* Табуляция `\t`
* Обратная косая черта `\`
* Кавычки `\"`

## Начальные шаги
Глобальная декларация.
```
global block <block code><tag name>
global block _SFCPB TANK_DATA
global block %SW CTRLMODE alias P_CTRLMODE
```
```
global genname <block code><global generic name>
global genname MC-2E VLV
global genname %SW VLV_M
```
Объявление переменных
```
!Локальные переменные
long ds
integer i, j,t1
!Глобальные переменные
global integer i,j,l,flag,vlv_tmp[14],sbs
global long tm1,tm2,tm
```
### Не много теории с комментариями
Оператор условия `if`
```
if(<выражение>)<оператор>
```
```
if(<выражение>)then
  <оператор>
else
  <оператор 2>
end if
```
```
if(<выражение>)then
  <оператор>
else if
  <оператор 2>
else
  <оператор 3>
end if
```
Оператор цикла `for next@`
```
for <переменная>=<начальное значение> to <конечное значение>[step <шаг>] ! по умолчанию step равен 1 и можно не писать
  <оператор>
next@
```
Оператор цикла `while` - пока выражение **истина** будут выполняться операторы между while и wend. Если выражение **ложь**, то операторы между while и wend *не выполняются*
```
while(1) !<выражение>
 !операторы
wend@
```
Оператор `switch` (переключатель)
```
switch(<выражение>)
 case <константа1>:
 ...
 case <константа2>
 ...
 otherwise: !Если результат не соответствует ни одной из констант, то выполняется здесь.
 ...
end switch
```
Оператор `delay` - задержка времени
```
delay <время задержки> !время указывается в мс
delay 2000 !время 2 сек
```
Оператор `format` - задание формата симвльной строки и сохранение ее в переменной символьной строки
```
format <форматирующая символьная строка>,<данные>;<переменная хранения символьной строки>
format "203M%d_1",i; s
format "TRUCK_STUB_T%d",i;t
```
Оператор `assign` присвоить - имя тэга может быть присвоено локальному родовому имени.
```
assign <имя тэга> to <локальное родовое имя>
assign "PIC001" to tag001 ! присваивание имени тега PIC001 локальному родовому имени tag001
```
Оператор `message` - используется для печати в качестве сообщения произвольной строки символов и сохранения ее в файле исторических данных
```
message <фомратирующая символьная строка>,<выходная величина>,PR,<номер элемента>,<параметр>
message "FCS0101. Блок %s MODE=AUT",t
message "Налив1. Запуск группы насосов"
message "201_%1dPT%2d 201_%1dPT%2d %d",n,i-n*10+49,n,i-n*10+59,al
```

### Примеры с разбором
Оператор `ssread` чтение данных подсистем

```
ssread <номер строки>,<номер карты>,<номер доступа>,<относительное положение>;
<переменная для хранения состояния данных>;
<переменная для хранения данных>:<тип данных>,<переменная для хранения данных>:<тип данных>,...
ssread 1, 1, 1, addr; dSts; n:integer, dir:integer, flag:integer
```
### Функции для символьных строк с примером
Оператор `mid()` извлекает произвольную символьную строку из середины символьной строки.
```		
mid(arg1, arg2, arg3)
!система возвращает символьную строку, состоящую из “arg3” символов,
!начиная с n-ого символа в “arg1”, n задается параметром “arg2”
s=mid(char1,i,1)
```
Конкатенация строк `cat(a)` - сцепляет символьные строки
```
cat(arg1, arg2)
!Система возвращает строковый параметр “arg2”,
!подсоединенный к строковому параметру “arg1” как результат действия функции.
char22=cat(char22,s)
```
Преобразование в строку `chr(a)`<br>
Преобразование в целое число `ichr(a)`
```
n=ichr(s)
s=chr(n)
```

```
format "TRUCK_STUB_T%d",i;t
message "FCS0101. Блок %s MODE=AUT",t
assign t to LOGIC
LOGIC.MODE = "AUT"
```

[назад](../index.md)
